<script>
    var $images_elem = $('#id_images');
    
    $images_elem.change(function(e){
        var $loading_elem = $('<p>Loading...</p>'),
            self = this,
            len = self.files.length,
            form_data = new FormData();
        
        for(var i = 0; i < len; i++){
            var file = self.files[i];
            
            if (!!file.type.match(/image.*/)) {  
                var reader = new FileReader();  
                reader.onloadend = function (e) {   
                    console.log(e.target.result);  
                };  
                reader.readAsDataURL(file);
                form_data.append('images[]', file);
            }   
        }
        
        form_data.append('csrfmiddlewaretoken', '{{ csrf_token}}');
        
        $.ajax({  
            url: "{% url 'bulk_loading_bulk_image_upload' %}",  
            type: "POST",  
            data: form_data,
            processData: false,  
            contentType: false,
            beforeSend: function(){
                $(self).after($loading_elem);
            },
            success: function(data){  
                data = JSON.parse(data);
                if(data.success){
                    $('#id_image_ids').val(data.image_ids);
                    
                } else{
                    alert('Something went wrong');
                }
            },
            complete: function(){
                $loading_elem.remove();
            }
        });
    });
    
    $images_elem.parent().validate({
        submitHandler: function(form){
            $images_elem.remove();
            form.submit();
        }
    });
</script>